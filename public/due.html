<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>DJ TOTY GEE LIVE</title>

    <!-- ✅ Use a compatible A-Frame -->
    <script src="https://aframe.io/releases/1.4.1/aframe.min.js"></script>

    <!-- ✅ Keep essential components -->
    <script src="https://cdn.jsdelivr.net/gh/ngokevin/aframe-event-set-component@master/dist/aframe-event-set-component.min.js"></script>
    <script src="https://unpkg.com/super-hands@3.0.3/dist/super-hands.min.js"></script>
    <script src="https://unpkg.com/aframe-look-at-component@0.8.0/dist/aframe-look-at-component.min.js"></script>
    <script src="https://unpkg.com/aframe-randomizer-components@3.0.1/dist/aframe-randomizer-components.min.js"></script>
    <script src="https://unpkg.com/aframe-environment-component@1.3.3/dist/aframe-environment-component.min.js"></script>

    <!-- ❌ Removed easyrtc + networked-aframe for now -->
    <!-- <script src="/easyrtc/easyrtc.js"></script> -->
    <!-- <script src="https://unpkg.com/networked-aframe@^0.12.0/dist/networked-aframe.min.js"></script> -->
    <!-- <script src="/js/spawn-in-circle.component.js"></script> -->

    <!-- ✅ Inline spawn-in-circle -->
    <script>
      AFRAME.registerComponent('spawn-in-circle', {
        schema: { radius: { type: 'number', default: 3 } },
        init: function () {
          const radius = this.data.radius;
          const angle = Math.random() * Math.PI * 2;
          const x = radius * Math.cos(angle);
          const z = radius * Math.sin(angle);
          this.el.setAttribute('position', { x, y: 1.7, z });
        },
      });
    </script>
  </head>
  <body style="background-color:black;">
    <a-scene>
      <a-assets>
        <img id="rug" crossorigin="anonymous"
             src="https://dragossido.github.io/public/assets/dj_toty_gee_3.png" />
        <video id="penguin-sledding" autoplay loop="true" crossorigin="anonymous"
               src="https://dragossido.github.io/public/assets/intro_vr.mp4"></video>
        <a-asset-item id="speaker" crossorigin="anonymous"
                      src="https://dragossido.github.io/public/assets/speaker.gltf"></a-asset-item>
        <a-asset-item id="trusse" crossorigin="anonymous"
                      src="https://dragossido.github.io/public/assets/trusse.gltf"></a-asset-item>
        <a-asset-item id="movinghead" crossorigin="anonymous"
                      src="https://dragossido.github.io/public/assets/movinghead.gltf"></a-asset-item>
        <a-asset-item id="spk_floor" crossorigin="anonymous"
                      src="https://dragossido.github.io/public/assets/spk_floor.gltf"></a-asset-item>
      </a-assets>

      <!-- Player -->
      <a-entity id="player" camera spawn-in-circle wasd-controls look-controls></a-entity>

      <!-- Stage Floor -->
      <a-entity position="0 0 0"
        geometry="primitive: plane; width: 10000; height: 10000;"
        rotation="-90 0 0"
        material="src: #rug; repeat: 10000 10000; transparent: true;
                  metalness:0.6; roughness: 0.4;">
      </a-entity>

      <!-- Stage and Screen -->
      <a-box position="0 2.5 -50" width="18" height="5" depth="2" color="red"></a-box>
      <a-plane position="0 9.65 -50" width="16" height="9"
               material="src:#penguin-sledding;"></a-plane>

      <!-- Speaker examples -->
      <a-entity gltf-model="#spk_floor" position="11 6 -50" rotation="0 0 180"
                scale="0.08 0.08 0.08"></a-entity>

      <a-sky color="#2f2c2c"></a-sky>
      <a-entity id="particles" particle-system="preset: snow"></a-entity>
    </a-scene>
  </body>
</html>
